---
title: "Configurer Salesforce comme fournisseur d’identité SAML"
permalink: "configure-salesforce-as-saml-identity-provider"
'description': "Cet article explique comment configurer Salesforce comme fournisseur d’identité SAML pour une utilisation avec Auth0."
'og:title': "Configurer Salesforce comme fournisseur d’identité SAML"
'og:description': "Cet article explique comment configurer Salesforce comme fournisseur d’identité SAML pour une utilisation avec Auth0."
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Configurer Salesforce comme fournisseur d’identité SAML"
'twitter:description': "Cet article explique comment configurer Salesforce comme fournisseur d’identité SAML pour une utilisation avec Auth0."
---

Configurez Salesforce en tant que fournisseur d’identité <Tooltip href="/docs/fr-CA/glossary?term=security-assertion-markup-language" tip="Security Assertion Markup Language (SAML)
Protocole normalisé permettant à deux parties d’échanger des informations d’authentification sans mot de passe." cta="Voir le glossaire">SAML</Tooltip> en procédant comme suit :

1. Obtenez le certificat et les métadonnées Salesforce.
2. Configurez Auth0 en tant que fournisseur de services.
3. Configurez le fournisseur d’identité (IdP) Salesforce.
4. Accordez des privilèges aux utilisateurs dans Salesforce.
5. Testez la connexion à l’IdP de Salesforce.

## Prérequis

Créez un compte sur [Salesforce.com](http://salesforce.com). Vous devez sélectionner un type de compte qui inclut la prise en charge du fournisseur d’identité.

## Obtenir le certificat et les métadonnées Salesforce

1. Connectez-vous à votre compte [Salesforce](http://salesforce.com).
2. Créez votre [domaine Salesforce](https://help.salesforce.com/apex/HTViewHelpDoc?id=domain_name_setup.htm&language=en_US).
3. Connectez-vous à votre domaine Salesforce `https://{yourDomain}.my.salesforce.com` et cliquez sur **Configuration** en haut à droite.
4. Dans la case Recherche rapide, saisissez Paramètres de l’authentification unique, sélectionnez **Paramètres de l’authentification unique**, puis cliquez sur **Modifier**.
5. Pour afficher les paramètres SAML SSO, sélectionnez **SAML activé**.
6. Sélectionnez le certificat par défaut et cliquez sur **Enregistrer**.
7. Cliquez sur **Télécharger le certificat** pour télécharger le certificat du fournisseur d’identité.
8. Cliquez sur **Télécharger les métadonnées** pour télécharger les métadonnées du fournisseur d’identité.

## Configurez Auth0 en tant que fournisseur de services

Configurez Auth0 en tant que fournisseur de services pour communiquer avec le fournisseur d’identité Salesforce pour l’authentification unique.

1. Rendez-vous à [Dashboard > Authentification > Entreprise](https://manage.auth0.com/#/connections/enterprise) et cliquez sur **SAML**.
2. Cliquez sur **Créer une connexion**.
3. Dans la fenêtre de configuration, saisissez les informations suivantes :

   <table class="table"><thead>
   <tr>
   <th>Paramètre</th>
   <th>Description</th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td><strong>Nom de connexion</strong></td>
   <td>Donnez un nom à votre connexion. Par exemple <strong>SFIDP</strong>.</td>
   </tr>
   <tr>
   <td><strong>Domaines de messagerie</strong></td>
   <td>Entrez le nom de domaine de messagerie à partir duquel vos utilisateurs se connecteront. Par exemple, si vos utilisateurs ont un domaine de messagerie `abc-example.com`, entrez-le dans ce champ. Vous pouvez entrer plusieurs domaines.</td>
   </tr>
   <tr>
   <td><strong>URL de connexion</strong></td>
   <td>Ouvrez le fichier de métadonnées que vous avez téléchargé depuis Salesforce et localisez la ligne qui contient la liaison `SingleSignOnService`. La valeur de l’attribut `location` sur cette ligne est votre URL de connexion. Elle devrait ressembler à quelque chose comme : `https://{sf-account-name}.my.salesforce.com/idp/endpoint/HttpRedirect` où `{sf-account-name}` est votre nom de domaine Salesforce.</td>
   </tr>
   <tr>
   <td><strong>URL de déconnexion</strong></td>
   <td>Entrez la même URL que vous avez saisie pour l’URL de connexion.</td>
   </tr>
   </tbody>
   </table>
4. Pour le **Certificat**, convertissez le certificat téléchargé depuis Salesforce au format .pem à l’aide de la commande suivante :
   `openssl x509 -in original.crt -out sfcert.pem -outform PEM`
   où `original.crt` est le nom du fichier .crt téléchargé.

   1. Cliquez sur **TÉLÉVERSER LE CERTIFICAT** et sélectionnez le fichier `.pem` que vous venez de créer. (`sfcert.pem` dans l’exemple ci-dessus). Pour l’instant, vous pouvez ignorer les champs restants.
   2. Cliquez sur **ENREGISTRER**.
   3. Cliquez sur **CONTINUER**. La fenêtre qui s’affiche révèle les métadonnées SAML du fournisseur de services Auth0. Gardez cette fenêtre ouverte car vous devrez saisir certaines de ces informations dans Salesforce pour terminer la configuration.

Vous pouvez accéder aux métadonnées d’une connexion SAML Auth0 avec cette syntaxe URL : `https://{yourDomain}/samlp/metadata?connection={yourConnectionName}`.

## Configurer Salesforce comme fournisseur d’identité

Configurez Salesforce avec les métadonnées Auth0. Il pourra ainsi recevoir et répondre aux demandes d’authentification basées sur SAML provenant d’Auth0.

1. Ouvrez le site [**salesforce.com**](http://salesforce.com).
2. Rendez-vous dans **Configuration** > **Gérer les applications**. Cliquez sur **Applications connectées**.
3. Créez une nouvelle application connectée et remplissez les champs suivants.

   <table class="table"><thead>
   <tr>
   <th>Paramètre</th>
   <th>Description</th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td><strong>Identifiant entité</strong></td>
   <td>`urn:auth0:YOUR_TENANT:YOUR_CONNECTION_NAME`</td>
   </tr>
   <tr>
   <td><strong>ACS URL</strong></td>
   <td>`https://{yourDomain}/login/callback`</td>
   </tr>
   <tr>
   <td><strong>Type de sujet</strong></td>
   <td>`Persistent ID`</td>
   </tr>
   <tr>
   <td><strong>Format de l’identifiant de nom</strong></td>
   <td>Choisissez-en un avec `emailAddress`</td>
   </tr>
   <tr>
   <td><strong>Émetteur</strong></td>
   <td>`https://{your-saleforce-domain}.my.salesforce.com`</td>
   </tr>
   </tbody>
   </table>
4. Cliquez sur **Enregistrer** pour terminer la configuration.

## Accorder des privilèges aux utilisateurs dans Salesforce

1. Ouvrez le site [**salesforce.com**](http://salesforce.com) et cliquez sur **Configuration**.
2. Sous **Gestion des utilisateurs**, cliquez sur **Profils**.
3. Faites défiler pour trouver le profil appelé **Utilisateur standard** (à la page 2).
4. Cliquez sur **Modifier** pour modifier le profil.
5. Faites défiler jusqu’à la section **Accès à l’application connectée**.
6. Cochez la case à côté du nom de votre application connectée pour l’activer pour ce profil.
7. Cliquez sur **Enregistrer**.
8. Sous **Gestion des utilisateurs**, cliquez sur **Utilisateurs**.
9. Cliquez sur **Modifier** pour modifier votre utilisateur test et définir le profil sur **Utilisateur standard**.
   Pour utiliser un profil Salesforce différent, activez l’application connectée pour ce profil et assurez-vous que tous les utilisateurs qui se connectent à partir de ce fournisseur d’identité Salesforce possèdent ce profil.

## Tester la connexion à Salesforce

1. Accédez à la section [Authentification > Entreprise](https://manage.auth0.com/#/connections/enterprise) d’Auth0 Dashboard. Sélectionnez le **fournisseur d’identité SAMLP**.
2. Cliquez sur le bouton **Essayer** pour la connexion SAML que vous avez créée précédemment. Depuis Auth0, vous serez redirigé vers la page de connexion de Salesforce.
3. Une fois sur l’**écran de connexion de Salesforce**, connectez-vous avec les iidentifiants que vous avez fournies lors de la création du compte Salesforce.

   1. Si la configuration SAML fonctionne, votre navigateur sera redirigé vers une page Auth0 indiquant **« Ça marche ! »**. Cette page affiche le contenu de l’assertion d’authentification SAML envoyée par l’IDP Salesforce à Auth0.
   2. Si cela ne fonctionne pas, vérifiez à nouveau les étapes ci-dessus et consultez la section **Dépannage** ci-dessous.

Lors du dépannage de l’authentification unique, il est souvent utile de capturer une trace HTTP de l’interaction et de l’enregistrer dans un fichier HAR. Pour en savoir plus, lisez [Générer et analyser des fichiers HAR](/docs/fr-CA/troubleshoot/guides/generate-har-files).

<Warning>

Avant de partager un fichier HAR avec quiconque (y compris Auth0), assurez-vous de supprimer ou d’obscurcir toutes les données sensibles, telles que :

* les informations confidentielles de l’utilisateur
* les informations personnelles identifiables (PII)
* les informations confidentielles relatives à l’application

Pour en savoir plus, consultez les articles suivants sur [Communauté Auth0](https://community.auth0.com) :

* [Assainissement des traces HTTP](https://community.auth0.com/t/sanitizing-http-traces/119488)
* [Comment assainir automatiquement un fichier de trace HTTP](https://community.auth0.com/t/how-to-sanitize-a-http-trace-file-automatically/120583)
* [Comment caviarder manuellement des informations sensibles](https://community.auth0.com/t/how-to-manually-redact-sensitive-information/122554)
* [Fichier HAR trop volumineux pour être téléversé dans le dossier d’assistance](https://community.auth0.com/t/har-file-is-too-large-to-upload-to-the-support-case/122488)

</Warning>

Une fois le traceur http en place, capturez la séquence de connexion du début à la fin et analysez la trace pour trouver la séquence de GET. Une redirection de votre site d’origine vers l’<Tooltip href="/docs/fr-CA/glossary?term=idp" tip="Fournisseur d’identité (IdP)
Service de stockage et de gestion des identités numériques." cta="Voir le glossaire">IDP</Tooltip> devrait s’afficher, ainsi qu’un affichage des identifiants, si vous avez dû vous connecter, puis une redirection vers l’URL de rappel. Le fichier HAR contiendra également la réponse SAML.

Assurez-vous que les témoins et JavaScript sont activés pour votre navigateur.

Assurez-vous que le profil de l’utilisateur dans Salesforce est autorisé à se connecter via l’IDP Salesforce (voir sectionº4 ci-dessus).