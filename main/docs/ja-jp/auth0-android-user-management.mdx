---
title: "Auth0.Android：ユーザー管理"
permalink: "auth0-android-user-management"
'description': "Auth0.Androidを使用してユーザーを管理する方法について説明します。"
'og:title': "Auth0.Android：ユーザー管理"
'og:description': "Auth0.Androidを使用してユーザーを管理する方法について説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Auth0.Android：ユーザー管理"
'twitter:description': "Auth0.Androidを使用してユーザーを管理する方法について説明します。"
---
import {AuthCodeBlock} from "/snippets/AuthCodeBlock.jsx";


<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/docs/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip>には、以下のタスクなど、アプリケーションのユーザー管理に使用できる機能が備わっています。

* さまざまなプロバイダーから取得した個別のユーザーアカウントを1つのプロファイルにリンクする。詳細については、「[ユーザーアカウントをリンクする](/docs/ja-jp/manage-users/user-accounts/user-account-linking)」をお読みください。
* ユーザーアカウントのリンクを解除して、個別のアイデンティティに戻す。
* ユーザーメタデータを更新する。詳細については、「[ユーザープロファイルでのメタデータの使い方](/docs/ja-jp/manage-users/user-accounts/metadata)」をお読みください。

## UsersAPIClientを初期化する

使い始めるには、プライマリーIDの`account`とトークンを渡して、新しい`UsersAPIClient`インスタンスを作成します。ユーザーのリンクでは、このプライマリーIDがデータを保持するユーザープロファイルになり、これに他のIDをリンクさせます。

export const codeExample = `val account = Auth0("{yourClientId}", "{yourDomain}")
val client = UsersAPIClient(account, "token")`;

<AuthCodeBlock children={codeExample} language="kotlin" />

## ユーザーをリンクする

ユーザーアカウントをリンクすると、ユーザーが他のアカウントでも認証できるようになります。認証にどのアカウントを使用しても、同じプロファイルでログインします。アカウントとリンクしない場合、Auth0はすべてのアカウントをそれぞれ個別のプロファイルとして扱います。

`link`メソッドは、プライマリーユーザーのIDとセカンダリーユーザーのトークン（このIDでログイン後に取得するトークン）という2つのパラメーターを受け付けます。ユーザーIDはこのユーザーアカウントの一意の識別子です。IDの形式が`facebook|1234567890`の場合、必要なIDは区切り文字のパイプに後続する部分です。

```kotlin lines
client
    .link("primary user id", "secondary user token")
    .start(object: Callback<List<UserIdentity>, ManagementException>() {
        override fun onSuccess(payload: List<UserIdentity>) {
            // Got the updated identities! Accounts linked.
        }

        override fun onFailure(error: ManagementException) {
            // Error!
        }
    })
```

## ユーザーをリンク解除する

ユーザーをリンク解除すると、アカウントを個別のプロファイルに戻します。`unlink`メソッドは、プライマリーユーザーのID、セカンダリーユーザーのID、（セカンダリーユーザーの）セカンダリープロバイダーという3つのパラメーターを受け付けます。

```kotlin lines
users
    .unlink("primary user id", "secondary user id", "secondary provider")
    .start(object: Callback<List<UserIdentity>, ManagementException>() {
        override fun onSuccess(payload: List<UserIdentity>) {
            // Got the updated identities! Accounts linked.
        }

        override fun onFailure(error: ManagementException) {
            // Error!
        }
    })
```

アカウントのリンクでは、セカンダリーアカウントのメタデータはプライマリーアカウントのメタデータとマージされません。同様に、2つのアカウントのリンク解除では、セカンダリーアカウントはプライマリーアカウントのメタデータを保持しません。

## ユーザーメタデータを更新する

メタデータの更新では、`metadata`オブジェクトを作成してから、`updateMetadata`メソッドを呼び出して、ユーザーIDと`metadata`オブジェクトを渡します。このオブジェクトの値は、同じキーを持つ既存の値を上書きするか、ユーザーメタデータに値がない場合は新しい値を追加します。

```kotlin lines
val metadata = mutableMapOf<String, Any?>()
metadata.put("name", listOf("My", "Name", "Is"));
metadata.put("phoneNumber", "1234567890");

users
    .updateMetadata("user id", metadata)
    .start(object: Callback<UserProfile, ManagementException>() {
        override fun onSuccess(payload: UserProfile) {
            // Metadata updated
        }

        override fun onFailure(error: ManagementException) {
            // Error!
        }
    })
```

