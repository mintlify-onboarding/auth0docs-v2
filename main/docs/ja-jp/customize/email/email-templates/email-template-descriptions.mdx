---
title: "メールテンプレートの説明"
permalink: "email-template-descriptions"
'description': "Auth0で使用されるメールテンプレートについて説明します。"
'og:title': "メールテンプレートの説明"
'og:description': "Auth0で使用されるメールテンプレートについて説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "メールテンプレートの説明"
'twitter:description': "Auth0で使用されるメールテンプレートについて説明します。"
---

## 確認メール

**［Verification Email（確認メール）］** をオンにするとデータベース接続にサインアップするユーザーにメールアドレスが正しいかどうかをたずねる確認メッセージが送られてくるので、メッセージに含まれるURLをクリックしてください。

すべてのメールテンプレートで利用できる共通変数のほかに、 **［Verification Email（確認メール）］** には、ユーザーがクリックしなければならないURLを指す`url`変数もあります。これを **［Message（メッセージ）］** フィールドで使用し、ユーザーが従うことができるリンクを作成します。

### 確認メールテンプレートのリダイレクト先の結果

メール確認操作を試行した後に、 **Redirect To（リダイレクト先）** URLをユーザーに送信するよう構成することができます。デフォルトでは、Auth0には以下のパラメーターが含まれます。

* `success`（`true`または`false`の値を持つ）はメール確認が正常に行われたかどうかを示します。
* `message`（結果に関する追加説明付き）。取り得る値は次のとおりです。

  + `Your email was verified.You can continue using the application.`（`success=true`を含む）
  + `This URL can be used only once`（`success=false`を含む）
  + `Access expired.`（`success=false`を含む）
  + `User account does not exist or verification code is invalid.`（`success=false`を含む）
  + `This account is already verified.`または`Your email address could not be verified.`（`success=false`を含む）

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

一部のエラーは、ユーザーをURLへリダイレクトする代わりに、[一般的なエラーページ](/docs/ja-jp/authenticate/login/auth0-universal-login/error-pages)へ送ります。

</Callout>

<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/docs/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip>でメールテンプレートを更新すると、リダイレクトリンクでメールアドレスを送信するのを防ぐことができます。例：
```
PATCH /api/v2/email-templates/reset_email
{
"includeEmailInRedirect": false
}`または
```
```
PATCH /api/v2/email-templates/verify_email
{
"includeEmailInRedirect": false
}
```

他に考えられるメッセージを適切に処理するために、ターゲットURLハンドラーも準備しておく必要があります。

## ウェルカムメール

ユーザーがメールアドレスを確認すると、 **ウェルカムメール** が送られてきます。 **確認メール** 機能をオフにすると、 **ウェルカムメール** がユーザーのサインアップ時（または初回ログイン時）にユーザーに送られます。

すべてのメールテンプレートで利用できる共通変数のほかに、 **Welcome（ようこそ）** テンプレートでは以下の変数も利用することができます。

* ユーザーが[Organization（組織）](/docs/ja-jp/manage-users/organizations/organizations-overview)からログインした場合：

  + `organization.id`
  + `organization.display_name`
  + `organization.name`
  + `organization.metadata`
  + `organization.branding.logo_url`
  + `organization.branding.colors.primary`
  + `organization.branding.colors.page_background`

## パスワード変更メール

ユーザーがパスワードの変更を要求すると、URLリンクを含んだ **Change Password（パスワードの変更）** メールが送られてきます。ユーザーがそのリンクをクリックすると、新しいパスワードを入力するための[パスワードリセットページ](/docs/ja-jp/customize/login-pages/classic-login/customize-password-reset-page)が表示されます。

すべてのメールテンプレートで利用できる共通変数のほかに、 **User Invitation（ユーザー招待）** テンプレートでは以下の変数も利用することができます。

* `url`：URLパスワードを変更するためにユーザーが選択します。これを **［Message（メッセージ）］** フィールドで使用し、次の例に示すように、ユーザーが従うことができるリンクを作成することができます。
  `<a href="/docs/ja-jp/{{ url }}">Click here to change your password</a>`
* ユーザーが[Organization（組織）](/docs/ja-jp/manage-users/organizations/organizations-overview)からログインした場合：

  + `organization.id`
  + `organization.display_name`
  + `organization.name`
  + `organization.metadata`
  + `organization.branding.logo_url`
  + `organization.branding.colors.primary`
  + `organization.branding.colors.page_background`

### パスワード変更テンプレートのリダイレクト先の結果

パスワード変更操作を試行した後に、 **Redirect To（リダイレクト先）** URLをユーザーに送信するよう構成することができます。デフォルトでは、Auth0には以下のパラメーターが含まれます。

* `success`（`true`または`false`の値を持つ）はパスワード変更が正常に行われたかどうかを示します。
* `message`（結果に関する追加説明付き）。取り得る値は次のとおりです。

  + `You can now login to the application with the new password.`（`success=true`を含む）
  + `This URL can be used only once`（`success=false`を含む）
  + `Access expired.`（`success=false`を含む）
  + `The operation cannot be completed.Please try again.`（`success=false`を含む）

他に考えられるメッセージを適切に処理するために、ターゲットURLハンドラーも準備しておく必要があります。

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

一部のエラーは、ユーザーをURLへリダイレクトする代わりに、[一般的なエラーページ](/docs/ja-jp/authenticate/login/auth0-universal-login/error-pages)へ送ります。

</Callout>

## ブロックされたアカウントメール

ユーザーが同じIPアドレスから10回以上ログインに失敗した場合、ユーザーアカウントはロックされ、 **Blocked Account（ブロックされたアカウント）** メールが送られてきます。このメールを受け取ったら、メールに含まれるリンクをクリックしないと、そのIPアドレスからログインし直すことはできません。

10回ログインに失敗する前にログインに成功すると、カウントがリセットされます。

すべてのメールテンプレートで利用できる共通変数のほかに、 **Blocked Account Email（ブロックされたアカウントメール）** テンプレートでは以下の変数も利用することができます。

* `user.source_ip`
* `user.city`
* `user.country`
* ユーザーが[Organization（組織）](/docs/ja-jp/manage-users/organizations/organizations-overview)からログインした場合：

  + `organization.id`
  + `organization.display_name`
  + `organization.name`
  + `organization.metadata`
  + `organization.branding.logo_url`
  + `organization.branding.colors.primary`
  + `organization.branding.colors.page_background`

このテンプレートには、ユーザーが従う必要があるリンクを作成するのに使用する`url`変数もあります。例：

`<a href="/docs/ja-jp/{{ url }}">Click here to unblock your account</a>`

### ブロックされたアカウントメールテンプレートのリダイレクト先の結果

アカウントのブロック解除操作を試行した後に、 **Redirect To（リダイレクト先）** URLをユーザーに送信するよう構成することができます。リダイレクト時に、Auth0には以下のパラメーターが含まれます。

* `email`はユーザーのメールを示します。
* `success`（`true`または`false`の値を持つ）はアカウントのブロック解除が正常に行われたかどうかを示します。
* `message`（結果に関する追加説明付き）。取り得る値は次のとおりです。

  + `Your account has been unblocked.`（`success=true`を含む）
  + `This URL can be used only once`（`success=false`を含む）
  + `Access expired.`（`success=false`を含む）

他に考えられるメッセージを適切に処理するために、ターゲットURLハンドラーも準備しておく必要があります。

## 侵害されたパスワードのアラートメール

サードパーティーによって漏洩したパスワードを使ってアプリケーションにアクセスしようとしていることがAuth0で検出されると、このメールタイプが必ず送られてきます。このタイプのメールは、Dashboardの[攻撃防御](https://manage.auth0.com/#/security/attack-protection)セクションの **［<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-1" href="/docs/ja-jp/glossary?term=breached-password-detection" tip="パスワード漏洩検知: サードパーティのWebサイトまたはアプリでのデータ漏洩で侵害されたユーザー名とパスワードの組み合わせをユーザーが使用した場合に、Auth0がユーザーに通知する攻撃防御の形式。" cta="用語集の表示">Breached Password Detection</Tooltip>（侵害されたパスワードの検出）］** を有効にした後でのみ設定されます。詳細については、「[侵害されたパスワードの検出](/docs/ja-jp/secure/attack-protection/breached-password-detection)」を参照してください。

すべてのメールテンプレートで利用できる共通変数のほかに、 **侵害されたパスワード（侵害されたパスワードのアラート）** メールでは以下の変数も利用することができます。

* ユーザーが[Organization（組織）](/docs/ja-jp/manage-users/organizations/organizations-overview)からログインした場合：

  + `organization.id`
  + `organization.display_name`
  + `organization.name`
  + `organization.metadata`
  + `organization.branding.logo_url`
  + `organization.branding.colors.primary`
  + `organization.branding.colors.page_background`

## MFAの登録メール

このメールは、<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/docs/ja-jp/glossary?term=multifactor-authentication" tip="多要素認証（MFA）: ユーザー名とパスワードに加えて、SMS経由のコードなどの要素を使用するユーザー認証プロセス。" cta="用語集の表示">MFA</Tooltip>登録招待が送信されるときに生成されます。このメッセージにはリンクが含まれており、リンクにアクセスすると、MFA登録エクスペリエンスが表示されます。

すべてのメールテンプレートで利用できる共通変数のほかに、`link`変数はこのメールタイプで利用することができ、以下の例に示すように、この操作のためのリンク構築に使用するURLが含まれています。

`<a href="/docs/ja-jp/{{ link }}">Enroll your MFA device</a>`

他のメールテンプレートとは異なり、正しい変数名は`link`であり、`url`ではありません。また、このメールテンプレートタイプでは、`connection.name`変数を使用することはできません。

## MFAの確認コードメール

このメールは、メールをMFA方式に使用し、確認コードを送信するよう要求するときに生成されます。共通変数のほかに、テンプレートではMFA確認用に使用されるコードを表示するための`code`変数も用意されています。例：

`<div>Your code is:{{ code }}</div>`

## ユーザー招待メール

ユーザーが[Organization（組織）](/docs/ja-jp/manage-users/organizations/organizations-overview)のメンバーになるよう招待されると、URLリンクを含んだ **User Invitation（ユーザー招待）** メールが送られてきます。リンクをクリックすると、デフォルトのログインルートにリダイレクトされます。詳細については、「[デフォルトのログインルートを設定する](/docs/ja-jp/authenticate/login/auth0-universal-login/configure-default-login-routes)」を参照してください。

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

ユーザーが招待を受け入れると、そのメールアドレスに検証済みのマークが付きます。

ユーザーがフェデレーションログインを通して招待を受け入れた場合、IDプロバイダーが返すメールアドレスは、招待の送信先メールアドレスと一致しなければなりません。メール検証は、後続のログイン時にIDプロバイダーが返した値でオーバライドされません。

期限までにユーザーが招待を受け入れなかった場合は、招待に期限切れのマークが付き、いずれ[Auth0 Dashboard](/docs/ja-jp/get-started/auth0-overview/dashboard)から削除されます。

</Callout>

すべてのメールテンプレートで利用できる共通変数のほかに、 **User Invitation（ユーザー招待）** テンプレートでは以下の変数も利用することができます。

* ユーザー招待情報（すべての情報をユーザー招待チケットから取得）

  + `inviter.name`
  + `app_metada`
  + `user_metadata`
  + `roles.id`
  + `roles.name`
  + `roles.description`
* 組織情報：

  + `organization.id`
  + `organization.display_name`
  + `organization.name`
  + `organization.metadata`
  + `organization.branding.logo_url`
  + `organization.branding.colors.primary`
  + `organization.branding.colors.page_background`

メールをローカライズするには、招待状の作成時に`user_metadata`で送信される`locale`を設定することができます。詳細については、「[メールテンプレートをカスタマイズする：多言語のメールテンプレート](/docs/ja-jp/customize/email/email-templates):」を参照してください。

### ユーザー招待テンプレートのリダイレクト結果

[デフォルトのログインルートを設定](/docs/ja-jp/authenticate/login/auth0-universal-login/configure-default-login-routes)しなければなりません。リンクを選択すると、ユーザーはこのルートに送られ、招待を受け入れます。リダイレクト時に、Auth0には以下のパラメーターが含まれます。

* `invitation`：招待チケットのID
* `organization`：ユーザーが招待されている組織のID
* `organization_name`：ユーザーが招待されている組織の名前

たとえば、組織対応のアプリケーションで **［Application Login URI（アプリケーションログインURI）］** が`https://myapp.com/login`に設定されている場合、エンドユーザーが受け取る招待メールには、以下のリンクが含まれます。`https://myapp.com/login?invitation={invitation_ticket_id}&organization={organization_id}&organization_name={organization_name}`

対象のログインルートは、用意された`invitation`と`organization`のキー値ペアを含んだ`/authorize`へのトランザクションを開始します。また、他に考えられるメッセージを適切に処理するための準備もしておく必要があります。

## パスワードレスメール

これまでのメールテンプレートタイプとは異なり、このメールテンプレートは「Email Templates（メールテンプレート）」セクションでは構成されておらず、[メールのパスワードレス接続の設定](https://manage.auth0.com/#/connections/passwordless)の一部となっています。

パスワードレスメールは、パスワードレスアクセスが要求されたときに、コード（アプリケーションに入力されたコードをユーザーに送られてくる）かリンク（リンクをクリックするとユーザーがアプリケーションに直接移動する）のいずれかの方法で送信されます。

すべてのテンプレートで利用できる共通変数のほかに、 **<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/docs/ja-jp/glossary?term=passwordless" tip="パスワードレス: 最初の要素としてパスワードに依存しない認証の形式。" cta="用語集の表示">Passwordless</Tooltip> Email（パスワードレスメール）** テンプレート用に特別に定義された以下の変数も使用することができます。

* `send`：要求されたパスワードレスメールのタイプに応じて、`link`、`link_ios`、`link_android`、または`code`の値が含まれます。
* `code`：アプリケーションにアクセスするための1回限りの使用コードが含まれます。
* `link`：このリンクをクリックすると、ユーザーはアプリケーションにアクセスすることができます（リンクタイプのパスワードレスメール専用）。
* `operation`：これがパスワードレスメールの変更操作である場合は、`change_email`になります。

デフォルトのテンプレートでは、上記の変数を使って、以下のような操作を行います。

```html lines
<!-- Email change content -->
{% if operation == 'change_email' %}
  <p>Your email address has been updated.</p>
{% else %}
  <!-- Signup email content -->
  {% if send == 'link' or send == 'link_ios' or send == 'link_android' %}
    <p>Click and confirm that you want to sign in to {{ application.name }}. This link will expire in five minutes.</p>
    <a href="/docs/ja-jp/{{ link }}">Sign in to {{ application.name }}</a>
    {% elsif send == 'code' %}
    <p>Your verification code is: <b>{{ code }}</b></p>
  {% endif %}
{% endif %}
```

Passwordless Email（パスワードレスメール）テンプレートでは、`user`オブジェクトの`email`プロパティのみを使用できます。

## もっと詳しく

* [メールテンプレートをカスタマイズする](/docs/ja-jp/customize/email/email-templates)
* [メールのハンドリングをカスタマイズする](/docs/ja-jp/customize/email/manage-email-flow)
* [アカウントのブロック通知メールをカスタマイズする](/docs/ja-jp/customize/email/customize-blocked-account-emails)