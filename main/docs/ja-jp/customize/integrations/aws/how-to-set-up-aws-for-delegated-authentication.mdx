---
title: "Amazon Web Servicesを委任認証用に構成する"
permalink: "how-to-set-up-aws-for-delegated-authentication"
'description': "Amazon Web Services（AWS）を委任認証用に構成する方法について説明します。"
'og:title': "Amazon Web Servicesを委任認証用に構成する"
'og:description': "Amazon Web Services（AWS）を委任認証用に構成する方法について説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Amazon Web Servicesを委任認証用に構成する"
'twitter:description': "Amazon Web Services（AWS）を委任認証用に構成する方法について説明します。"
---

Auth0では、Amazon Web Servicesを委任認証用に構成することができます。詳細については、「[Amazon Web Servicesをシングルサインオン用に構成する](/docs/ja-jp/customize/integrations/aws/configure-amazon-web-services-for-sso)」および「[カスタムオーソライザーを使用した安全なAWS API Gatewayエンドポイント](/docs/ja-jp/customize/integrations/aws/aws-api-gateway-custom-authorizers)」をお読みください。

## AWSでSAMLプロバイダーを作成する

1. AWSにログインし、[［IAM console（IAMコンソール）］](https://console.aws.amazon.com/iam)に移動します。左のナビゲーションメニューの **［Identity Providers（IDプロバイダー）］** を選択します。 **［Create Provider（プロバイダーの作成）］** をクリックします。次のパラメーターを設定します。

<table class="table"><thead>
<tr>
<th>パラメーター</th>
<th>説明とサンプル値</th>
</tr>
</thead>
<tbody>
<tr>
<td>Provider Type（プロバイダータイプ）</td>
<td>プロバイダーのタイプ。<Tooltip id="react-containers-DefinitionTooltip-0">`SAML`</Tooltip>に設定します。</td>
</tr>
<tr>
<td>Provider Name（プロバイダー名）</td>
<td>プロバイダーの説明的な名前。例：`auth0SamlProvider`など。</td>
</tr>
<tr>
<td>Metadata Document（メタデータドキュメント）</td>
<td>Auth0メタデータが含まれるファイルをアップロードします。ファイルは **［Dashboard］&gt;［Applications（アプリケーション）］&gt;［Application Settings（アプリケーション設定）］&gt;［Advanced Settings（高度な設定）］&gt;［Endpoints（エンドポイント）］&gt;［SAML Metadata URL（SAMLメタデータのURL）］** にあります。</td>
</tr>
</tbody>
</table>
2. **［Next Step（次の手順）］** をクリックします。
3. 設定を確認し、問題がなければ **［Create（作成）］** をクリックします。

## SAMLプロバイダーのロールを作成します。

プロバイダーを使用するには、ロールの信頼ポリシーのプロバイダーを使ってIAMロールを作成する必要があります。

1. IAMコンソールで[［Roles（ロール）］](https://console.aws.amazon.com/iam/home#/roles)に移動します。 **［Create role（ロールの作成）］** をクリックします。 **［Trust（信頼）］** ページにリダイレクトされます。 **［Select type of trusted entity（信頼されたエンティティのタイプの選択）］** で **［SAML 2.0 federation（SAML 2.0フェデレーション）］** を示します。以下の値を入力します。

<table class="table"><thead>
<tr>
<th>パラメーター</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>SAML Provider（SAMLプロバイダー）</td>
<td>新しいロールの名前</td>
</tr>
<tr>
<td>Attribute（属性）</td>
<td>`SAML:iss`</td>
</tr>
<tr>
<td>Value（値）</td>
<td>`urn:{yourDomain}`</td>
</tr>
</tbody>
</table>
2. **［Next:Permissions（次へ：アクセス許可）］** をクリックして続行します。
3. アクセス許可ポリシーを新しいロールにアタッチする必要があります。カスタムポリシーをアタッチします。1つ作成するには、 **［Create Policy（ポリシーの作成）］** をクリックします。
4. **［Create policy（ポリシーの作成）］** エディターが起動したら、 **［JSON］** タブに切り替えます。カスタムポリシーを用意します。

   ```json lines
   {
     "Version": "2012-10-17",
     "Statement": [{
         "Effect": "Allow",
         "Action": [
           "*"
         ],
         "Resource": [
         "arn:aws:s3:::{yourBucket}/<%= '${saml:sub}' %>",
         "arn:aws:s3:::{yourBucket}/<%= '${saml:sub}' %>/*"]
     }]
   }
   ```

   

   

   これによって、AWSでこのロールに含まれるユーザーが付与したアクセス権が定義されます。 **［Review policy（ポリシーの確認）］** をクリックします。
5. 作成したポリシーを確認します。ポリシーの **［Name（名前）］** （必須）と **［Description（説明）］** （任意）を入力してください。
6. 完了したら、 **［Create policy（ポリシーの作成）］** をクリックします。成功すると、新しいポリシーが作成されたことを示す次のメッセージが表示されます：「auth0SamlRolePolicy has been created（auth0SamlRolePolicyが作成されました）」
7. ロール作成ウィザードに戻り（手順 **2 - アクセス許可** に進んでいるはずです）、作成したばかりの新しいポリシーを見つけ、チェックボックスにチェックを入れてポリシーをロールにアタッチします。ポリシーを見つける際には、 **［Customer managed（カスタマー管理）］** フィルターを使用することを推奨します。
8. **［Next:Review（次へ：確認）］** をクリックして続行します。
9. ロールに関する情報を確認し、 **［Role name（ロール名）］** （必須）と **［Role description（ロールの説明）］** （任意）を入力します。アタッチしたポリシーも表示されます。すべて正しければ、 **［Create role（ロールの作成）］** をクリックして続行します。
10. 作成したら、プライマリ **ロール** ページにロールが表示されます。

## ARN値をコピーします。

以下の手順に沿って、プロバイダーARNとロールARNの各値を検索することができます。

### プロバイダーARN

IAMコンソールで[［Identity providers（IDプロバイダー）］](https://console.aws.amazon.com/iam/home#/providers)に移動します。お探しのロールを選択し、その概要ページを開きます。 **［Summary（概要）］** の先頭に表示されている **［Provider ARN（プロバイダーARN）］** 値をコピーします。

### ロールARN

IAMコンソールで[［Roles（ロール）］](https://console.aws.amazon.com/iam/home#/roles)に移動します。お探しのロールを選択し、その概要ページを開きます。 **［Summary（概要）］** の先頭に表示されている **［Role ARN（ロールARN）］** 値をコピーします。