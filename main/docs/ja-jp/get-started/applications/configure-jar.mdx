---
title: "JAR（JWT-Secured Authorization Request）を構成する"
permalink: "configure-jar"
'description': "アプリケーションにJWT-secured Authorization Requests（JAR）を構成する方法を説明します。"
'og:title': "JAR（JWT-Secured Authorization Request）を構成する"
'og:description': "アプリケーションにJWT-secured Authorization Requests（JAR）を構成する方法を説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "JAR（JWT-Secured Authorization Request）を構成する"
'twitter:description': "アプリケーションにJWT-secured Authorization Requests（JAR）を構成する方法を説明します。"
---
import {AuthCodeBlock} from "/snippets/AuthCodeBlock.jsx";

export const codeExample1 = `POST https://{yourTenant}.auth0.com/api/v2/clients/{yourClientId}/credentials
Authorization: Bearer <YOUR_ACCESS_TOKEN>
Content-Type: application/json
{
  "name": "My credentials for JAR",
  "credential_type": "public_key",
  "pem": "[YOUR PEM FILE CONTENT]",
  "alg": "RS256"
}`;

export const codeExample2 = `PATCH https://{yourTenant}.auth0.com/api/v2/clients/{yourClientId}
Authorization: Bearer <YOUR_ACCESS_TOKEN>
Content-Type: application/json
{
  "signed_request_object": {
    "credentials": [{"id": "[YOUR CREDENTIAL ID]"}]
  }
}`;

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

ハイリーレギュレーテッドアイデンティティ機能を使用するには、エンタープライズプランとハイリーレギュレーテッドアイデンティティアドオンが必要です。詳細については、「[Auth0の価格設定](https://auth0.com/pricing/)」を参照してください。

</Callout>

<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-3" href="/docs/ja-jp/glossary?term=json-web-token" tip="JSON Web Token（JWT）: 二者間のクレームを安全に表現するために使用される標準IDトークン形式（および多くの場合、アクセストークン形式）。" cta="用語集の表示">JWT</Tooltip>-secured Authorization Requests（JAR）を使用すると、OAuth2認可要求パラメーターが単一のJWT要求パラメーターにパッケージ化され、整合性保護のため署名されます。

## 前提条件

JARを使用するようにアプリケーションを構成する前に、[RSA鍵ペアを生成する](/docs/ja-jp/secure/application-credentials/generate-rsa-key-pair)必要があります。

<Warning>

資格情報の用途や目的ごとに個別のキーペアを生成する必要があります。たとえば、JAR認証と秘密鍵JWT認証の両方に同じキーペアを使用しないでください。

</Warning>

## アプリケーションに対するJARの構成

アプリケーションにJARを構成するには、<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/docs/ja-jp/glossary?term=auth0-dashboard" tip="Auth0 Dashboard: サービスを構成するためのAuth0の主製品。" cta="用語集の表示">Auth0 Dashboard</Tooltip>または<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/docs/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip>を使用できます。

<Tabs><Tab title="Auth0 Dashboard">

Auth0 Dashboardを使用して、以前生成されたRSAキーでJARを使用するアプリケーションを構成します。

1. [［Auth0 Dashboard］ > ［Applications（アプリケーション）］](https://manage.auth0.com/#/applications)に移動します。
2. JARで使用したいアプリケーションを選択します。
3. **［Application Settings（アプリケーションの設定）］** タブを選択します。
4. **［Authorization Requests（認可要求）］** セクションで、**［Require JWT-Secured Authorization Requests（JWT保護の認可要求をする）］** を有効にします。
5. 資格情報が割り当てられておらず、利用可能な資格情報がある場合、既存の資格情報の割り当てを要求されます。

   <Frame>![Dashboard > Application > Settings > Assign Existing Credentials](/docs/images/ja-jp/cdy7uua7fh8z/HQHhFWTtdfNa5TnZ1dwx6/ccaa87631feab761d7d23c45a24674bf/Existing_Creds_-_Japanese.png)</Frame>

6. 新しい資格情報を割り当てることもできます。

   <Frame>![Auth0 Dashboard > Applications > Settings > Assign New Credentials](/docs/images/ja-jp/cdy7uua7fh8z/7JfsCBwytWO6Q7hUvdtSwJ/f5ec2e430514faef17fb06c6735a0c61/New_Creds_-_JP.png)</Frame>

7. 以前生成されたRSAキーペアをアップロードして、新しい資格情報を追加し、割り当ててください。要求された場合、次の情報を入力します：

   * **［Name（名前）］** ：資格情報を識別する名前
   * **［Public Key（公開鍵）］** ：PEM形式のX.509証明書の公開鍵
   * **［Algorithm（アルゴリズム）］** ：JAR署名のアルゴリズムを選択します
   * **［Expiration Date（有効期限）］** ：資格情報の有効期限を設定します

</Tab><Tab title="Management API">

[Management API](https://auth0.com/docs/api/management/v2)で、`signed_request_object`クライアント構成プロパティを使用して、アプリケーションにJARを構成します。このオブジェクトプロパティには次のフィールドを含みます：

* `required`：JARを使用するために、すべての認可要求を`/authorize`と`/oauth/par`に送ります。詳細については、「[JWT保護の認可要求を使用した認可コードフロー](/docs/ja-jp/get-started/authentication-and-authorization-flow/authorization-code-flow/authorization-code-flow-with-jar)」と「[PARとJARを使用した認可コードフロー](/docs/ja-jp/get-started/authentication-and-authorization-flow/authorization-code-flow/authorization-code-flow-with-par-and-jar)」をお読みください。
* `credentials`：署名の検証に使用される資格情報IDの配列。

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

資格情報パラメーターは、新しいアプリケーションの作成時に資格情報作成をサポートする秘密鍵JWTパラメーター、`client_authentication_methods.private_key_jwt.credentials`と同じように動作します。詳細については、「[秘密鍵JWTを構成する](/docs/ja-jp/get-started/applications/configure-private-key-jwt)」をお読みください。

</Callout>

Management APIから、新しいアプリケーション、または既存のアプリケーションに対してJARを構成することができます。

#### 新しいアプリケーションに対するJARの構成

新しいアプリケーションを作成する際、`signed_request_object`としてPOST要求を送って、JARを構成します。そのPOST要求には、該当のクライアント資格情報（キーPEM）を登録することもできます。

```json lines
POST https://{yourTenant}.auth0.com/api/v2/clients
Authorization: Bearer <YOUR_ACCESS_TOKEN>
Content-Type: application/json
{
  "name": "My App using JAR",
  "signed_request_object": {
      "required": true,
"credentials": [{
        "name": "My credential for JAR",
        "credential_type": "public_key",
        "pem": "[YOUR PEM FILE CONTENT]",
        "alg": "RS256"
}]
  },
  "jwt_configuration": {
    "alg": "RS256"
  }
}
```

#### 既存のアプリケーションに対するJARの構成

既存のアプリケーションを更新する際、まずはクライアント資格情報を明確に作成する必要があります。次のPOST要求で、JARに対するクライアント資格情報を作成するためのPEMファイルコンテンツを使用します：




<AuthCodeBlock children={codeExample1} language="json" />

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

改行は、追加の書式を使わずに適切にJSONエンコードします。

</Callout>

次に、`signed_request_object`クライアント構成にクライアント資格情報を割り当てます。次のPATCH要求は、クライアント資格情報を`signed_request_object`と関連付けます：


<AuthCodeBlock children={codeExample2} language="json" />

</Tab></Tabs>

## もっと詳しく

* [JWT-Secured Authorization Requests（JAR）を使った認可コードフロー](/docs/ja-jp/get-started/authentication-and-authorization-flow/authorization-code-flow/authorization-code-flow-with-jar)
* [PARとJARを使った認可コードフロー](/docs/ja-jp/get-started/authentication-and-authorization-flow/authorization-code-flow/authorization-code-flow-with-par-and-jar)