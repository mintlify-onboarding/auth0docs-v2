---
title: "Management API v2エンドポイントの移行：クエリのページネーション"
permalink: "migrate-to-paginated-queries"
'description': "特定のManagement API v2 エンドポイントクエリにページネーションパラメーターを使用する方法を説明します。"
'og:title': "Management API v2エンドポイントの移行：クエリのページネーション"
'og:description': "特定のManagement API v2 エンドポイントクエリにページネーションパラメーターを使用する方法を説明します。"
'og:image': "https://cdn2.auth0.com/docs/1.14567.0/img/share-image.png"
'twitter:title': "Management API v2エンドポイントの移行：クエリのページネーション"
'twitter:description': "特定のManagement API v2 エンドポイントクエリにページネーションパラメーターを使用する方法を説明します。"
---

**2021年1月26日** （またはプライベートクラウドのバージョン2202）の後、<Tooltip data-tooltip-id="react-containers-DefinitionTooltip-0" href="/docs/ja-jp/glossary?term=management-api" tip="Management API: 顧客が管理タスクを実行できるようにするための製品。" cta="用語集の表示">Management API</Tooltip> v2エンドポイントへの要求は、パブリッククラウドのテナントに対して最大50個のアイテムを返します。より多くのアイテムを取得するには、`page`および`per_page`パラメーターを含める必要があります。**2020年7月21日** （またはプライベートクラウドのバージョン2108）から、 Auth0は、この変更に備えて、テナントログおよび移行トグルを表示します。

以下の基準に当てはまるテナントが影響を受けます。

* **2020年7月21日より前** に作成されたパブリッククラウドテナントまたはバージョン2108で導入のプライベートクラウド。
* 複数の結果を返す可能性のあるクエリに対して`per_page`パラメーターを渡すことなく、影響を受けるエンドポイントを積極的に呼び出す

以下のテナントは、デフォルトで新しいページネーション動作が有効になっており、2021年1月26日より後も現在と同じように動作します。

* **2020年7月21日以後** に作成されたパブリッククラウドテナントまたはバージョン2108以降で導入のプライベートクラウド。
* 影響を受けるエンドポイントを使用していない。
* 影響を受けるエンドポイントを使用しており、かつ`per_page`パラメーターを渡している、または単一の結果を常に返すクエリを実行している。

## 影響を受けるエンドポイント

以下のManagement API v2 エンドポイントへの呼び出しは、影響を受けます。

* [`GET /api/v2/clients`](https://auth0.com/docs/api/management/v2#!/Clients/get_clients)
* [`GET /api/v2/client_grants`](https://auth0.com/docs/api/management/v2#!/Clients/client_grants)
* [`GET /api/v2/grants`](https://auth0.com/docs/api/management/v2#!/Clients/grants)
* [`GET /api/v2/connections`](https://auth0.com/docs/api/management/v2#!/Clients/connections)
* [`GET /api/v2/device-credentials`](https://auth0.com/docs/api/management/v2#!/Clients/device_credentials)
* [`GET /api/v2/resource-servers`](https://auth0.com/docs/api/management/v2#!/Clients/resource_servers)
* [`GET /api/v2/rules`](https://auth0.com/docs/api/management/v2#!/Clients/rules)

廃止通知は、異なるクライアントおよびエンドポイントについて、現在複数アイテムを返すページネーションオプションなしの要求すべてに対して、１時間に１回、テナントログに記録されます。

## アクション

1. `page`および`per_page`パラメーターを提供して、影響を受けるエンドポイントへの呼び出しすべてを置き換えます。

   <table class="table"><thead>
   <tr>
   <th>パラメーター</th>
   <th>タイプ</th>
   <th>説明</th>
   </tr>
   </thead>
   <tbody>
   <tr>
   <td>`page`</td>
   <td>整数</td>
   <td>返される結果のページインデックス。最初のページは0になります。</td>
   </tr>
   <tr>
   <td>`per_page`</td>
   <td>整数</td>
   <td>1ページあたりの結果件数。このパラメーターが送信されない場合、ページ分割は無効になります。</td>
   </tr>
   </tbody>
   </table>
2. テナントログに廃止通知が表示されないことを確認します。要求が50個より多くのアイテムを返しているかどうか確認します。`details.size_exceeded`フィールドを見て、`true`になっているか確認します。

   1. 以下のログクエリを使用して、複数の結果でページネーションオプションなしで呼び出しすべてを返します。
      `type:depnote AND description:*Unpaginated*`
   2. 以下のログクエリを使用して、複数の結果でページネーションオプションなしで呼び出しすべてを返します。
      `type:depnote AND description:*Unpaginated* AND details.size_exceeded:true`

   要求を行うアプリケーションを特定するために、要求を行うために使用される`client_id`がログに含まれます。また、ログの`details.path`フィールドで使用されるエンドポイントを見つけることもできます。
3. テナントに対するManagement APIの非ページネーション要求を無効にする[［Dashboard］>［Tenant Settings（テナント設定）］>［Advanced（詳細設定）］>［Migration（移行）］](https://manage.auth0.com/#/tenant/advanced)に移動します。これにより、移行ウィンドウが閉じた後に期待される動作をシミュレートして、影響を受けるエンドポイントを呼び出し、最大50個の結果を返します。その日までいつでも、非ページネーションの要求を最び有効化できます。

### 拡張機能の更新

旧バージョンの[Auth0拡張機能](/docs/ja-jp/customize/extensions)およびカスタムの拡張機能を、ページネーションクエリのみ実行するようにするために、最新バージョンに更新する必要があるかもしれません。

1. 拡張機能URLに一致するIDのクライアントについて、廃止通知があるかテナントログを確認してください。その場合、その拡張機能を更新する必要があります。
2. [［Dashboard］ > ［Extensions（拡張機能）］](https://manage.auth0.com/#/extensions)に移動し、**［Installed Extensions（インストール済みの拡張機能）］** を選択して、拡張機能の **［Update（更新）］** リンクがあれば、それをクリックしてください。

### Deploy CLIツールの更新

`auth0-deploy-cli`ツールを使用している場合は、バージョン**5.3.0以降** に更新する必要があります。詳細については、[Deploy CLIツール](/docs/ja-jp/deploy-monitor/deploy-cli-tool)を参照してください。