---
description: Learn how to enable automatic user migration with your custom database.
'og:image': https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
'og:title': Configure Automatic Migration from Your Database
'og:url': https://auth0.com/docs/
permalink: configure-automatic-migration-from-your-database
title: Configure Automatic Migration from Your Database
'twitter:description': Learn how to enable automatic user migration with your custom
  database.
'twitter:title': Configure Automatic Migration from Your Database
---
Configure your Database connection to automatically migrate your users from an external user store to Auth0 with [custom database action scripts](/authenticate/database-connections/custom-db/templates).

<Warning>

If you try to use more than one migration method (for example, automatic migration then bulk user import), you may encounter a `DUPLICATED_USER` error. This error indicates that the user exists in Auth0's internal user store but not in your tenant. To correct this error, delete the user with the Auth0 Management API [Delete a Connection User](https://auth0.com/docs/api/management/v2#!/Connections/delete_users_by_email) endpoint and then re-attempt the import.

</Warning>

## Configure Database connection as custom

Create a Database connection, and then set it to custom.

1. Go to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/#/connections/database) and select the database to view.
2. Select the **Custom Database** view, and toggle on **Use my own database**.

   <Frame>![Auth0 Dashboard Authentication Database Connection Custom Database Settings Use Own Database Enabled](/images/cdy7uua7fh8z/11HPAdVwJMmnWbzMVjHCJ8/f75ff47f613a41778f266643f29ab2b1/2025-02-27_17-25-36.png)</Frame>
3. Select the **Settings** view, toggle on **Import Users to Auth0**, and select **Save**.

## Configure Database Action Scripts

Select the **Custom Database** view, and then locate **Database Action Scripts**.

<Frame>![Dashboard Authentication Database Connection Custom Database tab Database Action Scripts](/images/cdy7uua7fh8z/4LBIvvjaABo51It4eVCmX3/4ef14765c79cc5b7ecfa3f3155caa9eb/Screen_Shot_2021-05-18_at_8.54.55_PM.png)</Frame>

### Login

The [Login](/authenticate/database-connections/custom-db/templates/login) script executes each time a user who is not found in the Auth0 attempts to log in. It verifies that the user exists in the external user store without reprompting the user for their password.

### Get User

The [Get User](/authenticate/database-connections/custom-db/templates/get-user) script executes after any of the following scenarios:

* A user initiates signup attempt.
* A user initiates a change password flow.
* A user enters their login identifier when using Identifier First + Biometrics.
* The <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/glossary?term=Management+API">Management API</Tooltip> [Update a User's Email or Username](https://auth0.com/docs/api/v2#!/Users/patch_users_by_id) or [Create User](https://auth0.com/docs/api/management/v2#!/Users/post_users) endpoint is called.

If a user who has not been migrated confirms a password change and logs in successfully, their user profile will be created in the Auth0 with the new password. This user profile contains all the data returned in the Get User script. All subsequent logins for this user will be performed directly in Auth0.

## Verify user migration is complete

Verify that all users have been migrated to the Auth0 user store using the <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> or the Auth0 Management API.

1. Go to [Auth0 Dashboard > User Management > Users](https://manage.auth0.com/#/users), and review the list of users.
2. Use the Management API [List or Search Users](https://auth0.com/docs/api/v2#!/Users/get_users) endpoint.

## Disconnect external user store

Reconfigure the Database Action Scripts as no operation functions. This will prevent Auth0 from reaching out to your external user store to authenticate users.

<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

Make sure to leave the **Import Users to Auth0** option turned on. If you turn this option off Auth0 will only use the scripts to authenticate and perform other user actions instead of using the users that were imported locally.

</Callout>

1. Go to [Auth0 Dashboard > Authentication > Database](https://manage.auth0.com/#/connections/database), and then select your Database connection.
2. Switch to the **Custom Database** view, and then locate **Database Action Scripts.**
3. Update the **Login** script.

   ```javascript lines
   function login (email, password, callback) {
     return callback(null, null);
   }
   ```


   

   
4. Update the **Get User** script.

   ```javascript lines
   function getByEmail (email, callback) {
     return callback(null, null);
   }
   ```


   

   

## Troubleshoot user migration issues

If you encounter any issues with automatic migration, first read [Custom Database Connection and Action Script Best Practices](/authenticate/database-connections/custom-db/custom-database-connections-scripts).

### User already exists

The most common scenarios when you may encounter this issue:

* You delete a user from your Database connection and then try to recreate the user.
* You attempt to create a new user on your Database connection when the user already exists in your external user store.
* A user's migration process was interrupted.

During the user migration process, Auth0 first creates a partial user profile in an internal user store, and then creates a full user profile on your Database connection. If an issue occurs that prevents this full user profile from being created, you may encounter the `The user already exists` error.

You can usually resolve this issue by deleting the user from the Database connection, deleting the user from the internal user store, and then reattempting the migration process.

1. Check the `console.log()` statements with the [Real-time Webtask Logs extension](/customize/extensions/real-time-webtask-logs).
2. Delete the user with the Management API [Delete a User](https://auth0.com/docs/api/management/v2#!/Users/delete_users_by_id) endpoint.
3. Delete the user with the Management API [Delete a Connection User](https://auth0.com/docs/api/management/v2#!/Connections/delete_users_by_email) endpoint.
4. Instruct the user to log in or change their password to reattempt migration.

### Missing metadata

If a user is interrupted during the login or change password flow that initiates the migration process, Auth0 may not be able to transfer their metadata (`user_metadata` or `app_metadata`) along with their other profile data.

You can mitigate this scenario by creating an [Action](/customize/actions) that verifies the user's profile is missing metadata, retrieves it from the external use store, and then stores it in Auth0.

## Learn more

* [Bulk User Imports](/manage-users/user-migration/bulk-user-imports)
* [User Import / Export Extension](/manage-users/user-migration/user-import-export-extension)