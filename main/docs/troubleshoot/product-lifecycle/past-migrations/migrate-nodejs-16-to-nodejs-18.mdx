---
'og:description': Describes Auth0 Actions items affected by the Node.js v12+6 to Node.js
  v18 migration.
'og:image': https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
'og:title': Migrate from Node 12 and 16 to Node 18
'og:url': https://auth0.com/docs/
permalink: migrate-nodejs-16-to-nodejs-18
title: Migrate from Node 12 and 16 to Node 18
'twitter:description': Describes Auth0 Actions items affected by the Node.js v12+6
  to Node.js v18 migration.
'twitter:title': Migrate from Node 12 and 16 to Node 18
---
Long-term support (LTS) for Node.js 12 and 16 ended in 2023, which means the Node.js development team no longer back-ports critical security fixes to these versions. Running with Node 12 or 16 runtimes could expose your extensibility code to security vulnerabilities.

Node 18 extensibility runtime is generally available (GA) across our entire suite of extensibility offerings. This includes Actions, Rules, Hooks, Database Scripts, and Custom Social Connections. We strongly encourage everyone to update to Node 18 as soon as possible to adhere to best code security practices.

## General considerations

### Migrate Rules and Hooks to Actions

If you are using a discontinued extensibility runtime, we recommend taking the review of your Rules and Hooks implementation as an opportunity for migrating them to (Node 18) Actions. Determine which Rules and Hooks you can migrate to Actions by visiting [Actions Limitations](/docs/customize/actions/limitations). To learn more about migrating your Rules and Hooks to Actions, see [Migrate to Actions](/docs/customize/actions/migrate).

### Marketplace integrations

#### Social Connections Integrations

Use the [Management API](https://auth0.com/docs/api/management/v2) to identify a complete list of social connections that a Node runtime version change may impact. In particular, all potentially impacted social connections, either explicitly created as a custom social connection or initially added through the Marketplace, have the `strategy` attribute with a value of either `oauth1` or `oauth2`.

You can then paginate through all the existing custom social connections in a given tenant using the `GET` connections <Tooltip tip="Management API: A product to allow customers to perform administrative tasks." cta="View Glossary" href="/docs/glossary?term=Management+API">Management API</Tooltip> endpoint. For example, the following query options returns the names and identifiers of up to 100 custom social connections:

```http wrap lines
/api/v2/connections?strategy=oauth1&strategy=oauth2&include_totals=true&fields=name&per_page=100
```






The <Tooltip tip="Auth0 Dashboard: Auth0's main product to configure your services." cta="View Glossary" href="/docs/glossary?term=Auth0+Dashboard">Auth0 Dashboard</Tooltip> does not allow updating the scripts for custom social connections added through the Marketplace. If a script change is required to be compatible with Node 18, you must use the Management API.

## Migration tasks

### Create new custom Actions

To create a new custom Action with Node 18 through the Auth0 Dashboard:

1. Navigate to [Auth0 Dashboard > Actions > Library](https://manage.auth0.com/#/dashboard/actions/library).
2. Select **Create Action > Build from scratch**.
3. In the **Runtime\*** field, select **Node 18 (Recommended)**.
4. Write your custom Actions in Node 18, test, and deploy when ready.

### Upgrade existing custom Actions

You can individually upgrade existing custom Actions built on Node 12 or 16 to Node 18 and [revert to the previous version](/docs/customize/actions/manage-versions#revert-actions) using the older runtime. Upgrade Actions to Node 18 by creating and deploying a new version of the existing implementation with any required changes and set to use Node 18 as the runtime.

### Choose Node 18 for other extensibility products

The runtime used for the remaining (non-Actions) extensibility offerings is defined globally at the tenant's advanced settings level. Changing this setting impacts the following functionality at the same time:

* rules
* hooks
* custom database scripts
* custom social connection scripts

To change the tenant extensibility runtime setting in the Auth0 Dashboard:

1. Navigate to **Dashboard > Settings > Advanced**.
2. Scroll to the **Extensibility** section.
3. For **Runtime**, select **Node 18**.

Given that this is a global setting that impacts multiple extensibility features simultaneously, we recommend that you perform this step in your development tenant first, complete testing of all applicable extensibility features, and proceed to your production tenant only when you see no issues in development.

Specifically for Custom DB scripts you can [follow the steps as explained on this page](/docs/authenticate/database-connections/custom-db/custom-database-connections-scripts/environment) to individually verify a script against a specific runtime version before proceeding to change the global runtime version.

## Known breaking changes

### Magic npm modules

The Node 12 extensibility runtime supports using specific `npm` modules without explicitly requiring them in the extensibility code. Starting with Node 16 runtime, we removed support for this type of usage for the following modules:

* _
* async
* Auth0
* azure_storage
* bcrypt
* crypto
* couchbase
* cql
* ip
* <Tooltip tip="JSON Web Token (JWT): Standard ID Token format (and often Access Token format) used to represent claims securely between two parties." cta="View Glossary" href="/docs/glossary?term=jwt">jwt</Tooltip>
* Knex
* mongo
* mysql
* mysql_pool
* ObjectID
* pbkdf2
* pg
* postgres
* Pubnub
* q
* querystring
* sqlserver
* uuid
* xml2js
* xmldom
* xpath
* xtend

If you still have extensibility running on Node 12, consider the above when updating the code directly to Node 18. Before using a module, you must ensure that it is explicitly required.

In the context of Rules, Custom Database Connections, and Custom Social Connections, you must explicitly require a version of the module that is [listed as available for Node 18](https://auth0-extensions.github.io/canirequire/).

In Hooks and Actions, you must add the intended target version as an explicit dependency before requiring the module.

### Can I Require module versions removed

We removed support for the specified versions of the modules listed below for the Node 18 runtime from [Can I Require](https://auth0-extensions.github.io/canirequire/). This change impacts the extensibility code associated with Rules, Custom Database Connection Scripts, and Custom Social Connection Scripts.

<Warning>

The fetch user profile script for the following custom social connections ([Indeed](https://marketplace.auth0.com/integrations/indeed-social-connection), [monday.com](https://marketplace.auth0.com/integrations/monday-com-monday-com-social-connection), [Snapchat](https://marketplace.auth0.com/integrations/snapchat-social-connection), and [Tumblr](https://marketplace.auth0.com/integrations/tumblr-social-connection)), available through the Marketplace, used version `0.22.0` of the `axios` module, which is not available in Node 18. If you at use one of these connections, review and update their scripts as necessary through the [Management API](https://auth0.com/docs/api/management/v2).

</Warning>

<table class="table"><thead>
<tr>
<th>Module</th>
<th>Versions</th>
</tr>
</thead>
<tbody>
<tr>
<td>@analytics/google-analytics</td>
<td>0.4.0</td>
</tr>
<tr>
<td>@auth0/hapi</td>
<td>13.5.1, 13.6.0</td>
</tr>
<tr>
<td>@auth0/rule-utilities</td>
<td>0.1.0</td>
</tr>
<tr>
<td>@gitbeaker/node</td>
<td>17.0.1</td>
</tr>
<tr>
<td>@incognia/api</td>
<td>1.0.0</td>
</tr>
<tr>
<td>@octokit/rest</td>
<td>15.8.2</td>
</tr>
<tr>
<td>@sentry/node</td>
<td>5.6.2, 5.15.5, 6.2.0</td>
</tr>
<tr>
<td>acorn</td>
<td>1.2.2</td>
</tr>
<tr>
<td>airbrake</td>
<td>1.0.2</td>
</tr>
<tr>
<td>airgram</td>
<td>3.1.1</td>
</tr>
<tr>
<td>ajv</td>
<td>6.10.1</td>
</tr>
<tr>
<td>amazon-dax-client</td>
<td>1.2.2</td>
</tr>
<tr>
<td>amazon-mws-node</td>
<td>1.0.3</td>
</tr>
<tr>
<td>analytics</td>
<td>0.5.1</td>
</tr>
<tr>
<td>analytics-node</td>
<td>2.0.1, 3.5.0</td>
</tr>
<tr>
<td>applicationinsights</td>
<td>0.15.8, 0.18.0, 1.5.0, 1.8.8</td>
</tr>
<tr>
<td>async</td>
<td>1.0.0, 0.9.0, 2.1.2, 2.6.1</td>
</tr>
<tr>
<td>auth0</td>
<td>2.4.0, 2.1.0, 2.0.0, 0.8.2, 2.6.0, 2.7.0, 2.8.0, 2.9.1, 2.13.0, 2.17.0, 2.17.1, 2.19.0, 2.23.0, 2.27.0, 2.27.1, 2.30.0, 2.31.0, 2.32.0, 2.34.2, 2.35.0, 2.36.1, 2.36.2, 2.39.0, 3.0.1</td>
</tr>
<tr>
<td>auth0-authz-rules-api</td>
<td>4.0.0</td>
</tr>
<tr>
<td>auth0-ext-template-renderers</td>
<td>0.4.2</td>
</tr>
<tr>
<td>auth0-extension-express-tools</td>
<td>1.0.2, 1.1.5, 1.1.6, 2.0.0</td>
</tr>
<tr>
<td>auth0-extension-hapi-tools</td>
<td>1.0.0, 1.1.0, 1.2.0, 1.2.1, 1.2.2, 1.3.0</td>
</tr>
<tr>
<td>auth0-extension-tools</td>
<td>1.0.0, 1.2.1, 1.3.1, 1.3.2, 1.4.0</td>
</tr>
<tr>
<td>auth0-magic</td>
<td>3.1.0</td>
</tr>
<tr>
<td>auth0-oauth2-express</td>
<td>0.0.1, 0.0.3, 1.1.5</td>
</tr>
<tr>
<td>auth0-source-control-extension-tools</td>
<td>3.0.10, 3.0.9, 3.1.4, 3.4.0, 3.5.1, 4.0.3, 4.0.5, 4.0.6, 4.0.7, 4.1.1, 4.1.2, 4.1.3, 4.1.5, 4.1.7, 4.1.9</td>
</tr>
<tr>
<td>aws-sdk</td>
<td>2.2.30, 2.1.31, 2.1.13, 2.4.13, 2.5.3, 2.197.0, 2.291.0, 2.458.0, 2.593.0</td>
</tr>
<tr>
<td>axios</td>
<td>0.15.2, 0.18.0, 0.19.2, 0.21.1, 0.21.3, 0.22.0, 0.27.2</td>
</tr>
<tr>
<td>azure</td>
<td>0.10.6</td>
</tr>
<tr>
<td>azure-storage</td>
<td>0.4.4, 0.4.1, 0.9.0</td>
</tr>
<tr>
<td>babel</td>
<td>5.4.7, 5.1.9</td>
</tr>
<tr>
<td>bcrypt</td>
<td>4.0.0</td>
</tr>
<tr>
<td>bluebird</td>
<td>2.9.26, 3.4.6</td>
</tr>
<tr>
<td>body-parser</td>
<td>1.12.4</td>
</tr>
<tr>
<td>boom</td>
<td>2.7.2</td>
</tr>
<tr>
<td>botbuilder</td>
<td>0.9.0</td>
</tr>
<tr>
<td>bson</td>
<td>0.3.2, 4.4.0</td>
</tr>
<tr>
<td>cookie-parser</td>
<td>1.3.5</td>
</tr>
<tr>
<td>datadog-metrics</td>
<td>0.8.2, 0.9.0, 0.9.2, 0.9.3</td>
</tr>
<tr>
<td>disposable-email-domains</td>
<td>1.0.14, 1.0.15, 1.0.56</td>
</tr>
<tr>
<td>dockerode</td>
<td>2.1.4, 2.0.3</td>
</tr>
<tr>
<td>dotenv</td>
<td>0.4.0, 2.0.0</td>
</tr>
<tr>
<td>easy-pbkdf2</td>
<td>0.0.2</td>
</tr>
<tr>
<td>ejs</td>
<td>2.3.1</td>
</tr>
<tr>
<td>engine.io-client</td>
<td>1.5.1</td>
</tr>
<tr>
<td>express</td>
<td>4.12.4, 4.14.0, 4.16.3</td>
</tr>
<tr>
<td>express-jwt</td>
<td>3.1.0, 5.1.0</td>
</tr>
<tr>
<td>faunadb</td>
<td>2.11.1, 4.1.1</td>
</tr>
<tr>
<td>filter-object</td>
<td>2.1.0</td>
</tr>
<tr>
<td>firebase</td>
<td>7.12.0</td>
</tr>
<tr>
<td>firebase-admin</td>
<td>4.0.4, 5.0.0, 6.0.0, 8.0.0, 8.12.1</td>
</tr>
<tr>
<td>form-data</td>
<td>0.2.0</td>
</tr>
<tr>
<td>getstream</td>
<td>3.4.1</td>
</tr>
<tr>
<td>gitlab</td>
<td>1.7.0</td>
</tr>
<tr>
<td>google-auth-library</td>
<td>1.0.0</td>
</tr>
<tr>
<td>google-libphonenumber</td>
<td>2.0.7, 3.2.8, 3.2.10</td>
</tr>
<tr>
<td>googleapis</td>
<td>2.1.6, 34.0.0</td>
</tr>
<tr>
<td>got</td>
<td>3.2.0, 9.2.1, 10.7.0, 11.3.0, 11.5.2</td>
</tr>
<tr>
<td>hapi</td>
<td>13.5.0</td>
</tr>
<tr>
<td>hapi-auth-jwt2</td>
<td>7.0.1</td>
</tr>
<tr>
<td>hapi-swagger</td>
<td>7.4.0</td>
</tr>
<tr>
<td>hoek</td>
<td>2.14.0</td>
</tr>
<tr>
<td>http-proxy</td>
<td>1.11.1</td>
</tr>
<tr>
<td>ibm_db</td>
<td>2.6.4</td>
</tr>
<tr>
<td>ip</td>
<td>0.3.2, 0.0.1</td>
</tr>
<tr>
<td>ipaddr.js</td>
<td>1.0.1</td>
</tr>
<tr>
<td>joi</td>
<td>6.10.1</td>
</tr>
<tr>
<td>jose</td>
<td>3.19.0</td>
</tr>
<tr>
<td>jsforce</td>
<td>1.6.0</td>
</tr>
<tr>
<td>jsonwebtoken</td>
<td>5.7.0, 5.0.1, 5.0.0, 7.1.9, 8.5.0</td>
</tr>
<tr>
<td>jwks-rsa</td>
<td>1.0.0, 1.1.1, 1.6.0</td>
</tr>
<tr>
<td>ldapjs</td>
<td>1.0.0</td>
</tr>
<tr>
<td>lodash</td>
<td>3.10.1, 3.9.3, 2.4.1, 4.8.2, 4.17.10, 4.17.19</td>
</tr>
<tr>
<td>lru-cache</td>
<td>2.6.4</td>
</tr>
<tr>
<td>mixpanel</td>
<td>0.4.0</td>
</tr>
<tr>
<td>mkdirp</td>
<td>0.5.1</td>
</tr>
<tr>
<td>moment</td>
<td>2.10.3, 2.11.2</td>
</tr>
<tr>
<td>mongodb</td>
<td>2.0.48, 2.0.33, 2.0.27, 2.2.11, 3.1.4, 4.1.0, 3.6.10, 3.5.11</td>
</tr>
<tr>
<td>mongoose</td>
<td>4.1.6</td>
</tr>
<tr>
<td>morgan</td>
<td>1.5.3</td>
</tr>
<tr>
<td>mysql</td>
<td>2.7.0, 2.6.2, 2.0.0-alpha8, 2.15.0</td>
</tr>
<tr>
<td>mysql2</td>
<td>1.5.3</td>
</tr>
<tr>
<td>nano</td>
<td>6.2.0</td>
</tr>
<tr>
<td>neo4j-driver</td>
<td>1.7.1</td>
</tr>
<tr>
<td>node-fetch</td>
<td>2.6.0</td>
</tr>
<tr>
<td>node-jose</td>
<td>0.9.2</td>
</tr>
<tr>
<td>node-rdkafka</td>
<td>2.10.1</td>
</tr>
<tr>
<td>nodemailer</td>
<td>2.5.0</td>
</tr>
<tr>
<td>nsp</td>
<td>2.4.0</td>
</tr>
<tr>
<td>oauth</td>
<td>0.9.12</td>
</tr>
<tr>
<td>passport-wsfed-saml2</td>
<td>2.11.4</td>
</tr>
<tr>
<td>pg</td>
<td>4.5.7, 4.3.0, 4.1.1, 6.1.2, 7.17.1</td>
</tr>
<tr>
<td>postmark</td>
<td>1.3.1</td>
</tr>
<tr>
<td>q</td>
<td>1.0.1</td>
</tr>
<tr>
<td>qs</td>
<td>3.1.0</td>
</tr>
<tr>
<td>ramda</td>
<td>0.18.0, 0.23.0</td>
</tr>
<tr>
<td>range_check</td>
<td>0.0.1</td>
</tr>
<tr>
<td>raw-body</td>
<td>2.1.0</td>
</tr>
<tr>
<td>react</td>
<td>15.3.2</td>
</tr>
<tr>
<td>redis</td>
<td>0.12.1</td>
</tr>
<tr>
<td>request</td>
<td>2.56.0, 2.55.0, 2.27.0, 2.67.0, 2.73.0, 2.75.0, 2.81.0, 2.83.0, 2.88.0</td>
</tr>
<tr>
<td>rethinkdb</td>
<td>2.1.1, 2.0.0-1, 2.0.0</td>
</tr>
<tr>
<td>rollbar</td>
<td>0.6.2, 2.12.2</td>
</tr>
<tr>
<td>semver</td>
<td>4.3.4</td>
</tr>
<tr>
<td>sendgrid</td>
<td>1.8.0, 3.0.7</td>
</tr>
<tr>
<td>sequelize</td>
<td>3.1.1</td>
</tr>
<tr>
<td>soap</td>
<td>0.23.0</td>
</tr>
<tr>
<td>socket.io</td>
<td>1.3.5</td>
</tr>
<tr>
<td>socket.io-client</td>
<td>1.3.5</td>
</tr>
<tr>
<td>splunk-bunyan-logger</td>
<td>0.9.1</td>
</tr>
<tr>
<td>ssh2</td>
<td>0.4.13</td>
</tr>
<tr>
<td>stamplay</td>
<td>1.0.6, 1.0.5, 1.0.3</td>
</tr>
<tr>
<td>stripe</td>
<td>3.3.4, 4.14.0, 4.24.0, 7.1.0, 7.4.0, 8.52.0</td>
</tr>
<tr>
<td>sumo-logger</td>
<td>1.5.5</td>
</tr>
<tr>
<td>superagent</td>
<td>1.2.0, 3.8.3, 4.1.0</td>
</tr>
<tr>
<td>tedious</td>
<td>6.6.2, 1.11.0, 0.1.4, 8.3.1, 9.2.1</td>
</tr>
<tr>
<td>tough-cookie</td>
<td>1.2.0</td>
</tr>
<tr>
<td>twilio</td>
<td>2.2.1, 3.6.0, 3.57.0</td>
</tr>
<tr>
<td>twit</td>
<td>1.1.20</td>
</tr>
<tr>
<td>uuid</td>
<td>2.0.3, 2.0.1, 3.1.0, 3.3.2, 7.0.3, 8.0.0</td>
</tr>
<tr>
<td>vso-node-api</td>
<td>3.1.1</td>
</tr>
<tr>
<td>watson-developer-cloud</td>
<td>2.0.1</td>
</tr>
<tr>
<td>winston</td>
<td>1.0.0, 0.8.1, 3.1.0</td>
</tr>
<tr>
<td>xml2js</td>
<td>0.4.8, 0.2.8</td>
</tr>
<tr>
<td>xmlbuilder</td>
<td>2.6.4</td>
</tr>
<tr>
<td>xmldom</td>
<td>0.1.19, 0.1.13</td>
</tr>
<tr>
<td>xpath</td>
<td>0.0.5</td>
</tr>
<tr>
<td>xtend</td>
<td>1.0.3</td>
</tr>
</tbody>
</table>

### Secure renegotiation required by default for TLS connections

Node.js 18 requires secure renegotiation (RFC 5746) for TLS connections by default, a consequence of the requirement being introduced in the underlying OpenSSL dependency.

If your extensibility code performs external network calls, the target servers must support secure renegotiation, or otherwise, the requests will fail, and you will receive an error similar to:

```text wrap lines
Error: write EPROTO C0BAF076:error:0A000152:SSL routines:final_renegotiate:unsafe legacy renegotiation disabled:../deps/openssl/openssl/ssl/statem/extensions.c:922:
```






Given this security-related change, we recommend that you ensure that all target servers are updated to support secure renegotiation. If the servers in question are third-party servers that are not under your control, you can evaluate the possibility of opting into the previous behavior.

For example, for the `axios` library, the following code snippet illustrates how to opt-in to the legacy behavior:

```javascript lines
const axios = require('axios');
const https = require('https');
const crypto = require('crypto');

axios.get(
  'https://[LEGACY_SERVER]', 
  {
    httpsAgent: new https.Agent(
      {
        secureOptions: crypto.constants.SSL_OP_LEGACY_SERVER_CONNECT
      }
    )
  })
```



