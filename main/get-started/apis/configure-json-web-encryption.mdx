---
description: Learn how to configure JSON Web Encryption (JWE) for an API.
'og:image': https://cdn2.auth0.com/docs/1.14553.0/img/share-image.png
'og:title': Configure JSON Web Encryption (JWE)
'og:url': https://auth0.com/docs/
permalink: configure-json-web-encryption
title: Configure JSON Web Encryption (JWE)
'twitter:description': Learn how to configure JSON Web Encryption (JWE) for an API.
'twitter:title': Configure JSON Web Encryption (JWE)
---
<Callout icon="file-lines" color="#0EA5E9" iconType="regular">

To use Highly Regulated Identity features, you must have an Enterprise Plan with the Highly Regulated Identity add-on. Refer to [Auth0 Pricing](https://auth0.com/pricing/) for details.

</Callout>

By default, Auth0 issues <Tooltip tip="Access Token: Authorization credential, in the form of an opaque string or JWT, used to access an API." cta="View Glossary" href="/glossary?term=access+tokens">access tokens</Tooltip> that are formatted as a signed [JSON Web Token (JWT)](/secure/tokens/json-web-tokens), meaning that while they are integrity protected, clients and other intermediaries can still inspect them. This can lead to a loss of information privacy on data intended only to be exposed to a <Tooltip tip="Resource Server: Server hosting protected resources. Resource servers accept and respond to protected resource requests." cta="View Glossary" href="/glossary?term=resource+server">resource server</Tooltip>.

To prevent unauthorized inspection of access tokens, Auth0 supports the use of nested <Tooltip tip="JSON Web Token (JWT): Standard ID Token format (and often Access Token format) used to represent claims securely between two parties." cta="View Glossary" href="/glossary?term=JWT">JWT</Tooltip> access tokens, where access information is signed in a JWT and then encrypted and represented with JSON Web Encryption (JWE). Resource servers are expected to both decrypt these access tokens and verify the signature of the JWT payload while the information is opaque to any other parties.

## Generate RSA key pair

Before configuring an API to use JWE, you must [generate an RSA key pair](/secure/application-credentials/generate-rsa-key-pair).

The private key must be kept secret. Upload the public key to Auth0 encoded in PEM format as described in [Generate RSA Key Pair](/secure/application-credentials/generate-rsa-key-pair). Only the resource server or API server can securely access the private key to decrypt the access token.

## Configure JWE for an API

<Tabs><Tab title="Auth0 Dashboard">

Use the [Auth0 Dashboard](https://manage.auth0.com/) to configure JWE for your API. To begin, enable the **JSON Web Encryption (JWE)** toggle under **Token Settings** for your API.

<Frame>![](/images/cdy7uua7fh8z/5xHKQ3rKN7DZogzD5qFDLp/8747f7f3d36c578e0f4622929cefb8e9/Access_Tokens_Settings_-_English.png)</Frame>

When prompted, add a JSON Web Encryption (JWE) key:

* Enter a friendly name for easy identification.
* Upload a certificate with the public key encoded in PEM format.
* Select the encryption algorithm.
* (Optional) Enter a key identifier.

Click **Add** to save the JWE key, which will generate a thumbprint of the certificate.

</Tab><Tab title="Management API">

Use the [Auth0 Management API](https://auth0.com/docs/api/management/v2) to configure JWE for a resource server or API server. You must configure JWE for each API, so each API has its own public encryption key.

The following POST request configures a new API to receive encrypted access tokens:

```bash lines
curl -X POST --location "https://{domain}/api/v2/resource-servers" \
    -H "Authorization: Bearer {managementAccessToken}" \
    -H "Content-Type: application/json" \
    --data-raw '{
  "name": "{apiName}",
  "identifier": "{apiIdentifier}",
  "token_encryption": {
    "format": "compact-nested-jwe",
    "encryption_key":
    {
      "name": "{credentialName}",
      "pem": "{pem}",
      "alg": "{alg}",
      "kid": "{kid}"
    }
  }
}'
```






The following table explains what the different parameters mean:

<table class="table"><thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Required?</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>apiName</code></td>
<td>Required</td>
<td>The name of your new API.</td>
</tr>
<tr>
<td><code>apiIdentifier</code></td>
<td>Required</td>
<td>The unique identifier for your API. This will be used as your token audience.</td>
</tr>
<tr>
<td><code>credentialName</code></td>
<td>Optional</td>
<td>The name for your public key.</td>
</tr>
<tr>
<td><code>pem</code></td>
<td>Required</td>
<td>Public key encoded in PEM format.</td>
</tr>
<tr>
<td><code>alg</code></td>
<td>Required</td>
<td>The encryption algorithm must be either <code>RSA-OAEP-256</code>, <code>RSA-OAEP-384</code>, or <code>RSA-OAEP-512</code>.</td>
</tr>
<tr>
<td><code>kid</code></td>
<td>Optional</td>
<td>The identifier used to write to the <code>kid</code> header in your JWE token. This can be used to identify the key used for encryption during key rotation.</td>
</tr>
</tbody>
</table>

The response contains the `id` property which uniquely identifies the resource server. The response also contains a generated `thumbprint_sha256` field that can be used to identify the credential. Auth0 will not return key material after initial creation (in this case, your PEM).

There are many ways to generate the `thumbprint_sha256`. For more information, see the [RFC 8705 OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens](https://datatracker.ietf.org/doc/html/rfc8705#name-jwt-certificate-thumbprint-).

To ensure that you generated the correct `thumbprint_sha256`, you can use the following Node.js code sample to extract the thumbprint:

```javascript lines
const fs = require('fs');
const crypto = require('crypto');

const { calculateJwkThumbprint, exportJWK } = require('jose');

const publicKeyObject = crypto.createPublicKey(fs.readFileSync('./my_cert.pem'));
exportJWK(publicKeyObject).then((jwk) => {
  calculateJwkThumbprint(jwk, 'sha256').then((thumbprint) => {
    console.log(thumbprint);
  });
});
```






</Tab></Tabs>

## Learn more

* [JSON Web Encryption](/secure/tokens/access-tokens/json-web-encryption)