---
title: "React Nativeアプリケーションにログインを追加する"
permalink: "interactive"
'description': "このチュートリアルは、Auth0を使用して、React Nativeアプリケーションにユーザーログインを追加する方法について説明します。"
'og:title': "React Nativeアプリケーションにログインを追加する"
'og:description': "このチュートリアルは、Auth0を使用して、React Nativeアプリケーションにユーザーログインを追加する方法について説明します。"
'og:image': "/docs/media/platforms/react.png"
'twitter:title': "React Nativeアプリケーションにログインを追加する"
'twitter:description': "このチュートリアルは、Auth0を使用して、React Nativeアプリケーションにユーザーログインを追加する方法について説明します。"
sidebarTitle: React Native
---

import { Recipe, Content, Section, SideMenu, SideMenuSectionItem, SignUpForm } from "/snippets/recipe.jsx";
import { LoggedInForm } from "/snippets/Login.jsx";
import App from "/snippets/quickstart/native/react-native/app.js.mdx";
import App2 from "/snippets/quickstart/native/react-native/app.js2.mdx";
import App3 from "/snippets/quickstart/native/react-native/app.js3.mdx";
import App4 from "/snippets/quickstart/native/react-native/app.js4.mdx";

export const sections = [
  { id: "auth0を構成する", title: "Auth0を構成する" },
  { id: "依存関係をインストールする", title: "依存関係をインストールする" },
  { id: "auth0をアプリケーションに統合する", title: "Auth0をアプリケーションに統合する" },
  { id: "auth0providerコンポーネントを構成する", title: "Auth0Providerコンポーネントを構成する" },
  { id: "アプリケーションにログインを追加する", title: "アプリケーションにログインを追加する" },
  { id: "アプリケーションにログアウトを追加する", title: "アプリケーションにログアウトを追加する" },
  { id: "ユーザープロファイル情報を表示する", title: "ユーザープロファイル情報を表示する" }
]

<Recipe>
  <Content>
    このクイックスタートは、React Nativeフレームワーク用です。ExpoアプリケーションにAuth0を統合するには、「[Expoクイックスタート](/ja-jp/quickstart/native/react-native-expo/interactive)」参照してください。

      <Section id={sections[0].id} title={sections[0].title} stepNumber="1">
      Auth0のサービスを利用するには、Auth0 Dashboadに設定済みのアプリケーションがある必要があります。Auth0アプリケーションは、プロジェクトに認証を構成する場所です。

      ### アプリケーションを構成する

      対話型のセレクターを使ってAuth0アプリケーションを新規作成するか、統合したいプロジェクトを表す既存のアプリケーションを選択します。Auth0のすべてのアプリケーションには英数字からなる一意のクライアントIDが割り当てられており、アプリケーションのコードがSDKを通じてAuth0 APIを呼び出す際に使用されます。

      このクイックスタートを使って構成されたすべての設定は、[Dashboard](https://manage.auth0.com/#/)のアプリケーションを自動更新します。今後、アプリケーションの管理もDashboardで行えます。

      完成した構成を詳しく見るには、Dashboardのサンプルアプリケーションをご覧ください。

      ### Callback URLとログアウトURLを構成する

      Auth0はCallback URLとログアウトURLを呼び出して、ユーザーをアプリケーションにリダイレクトで戻します。Auth0は、ユーザーを認証した後にCallback URLを呼び出し、セッションのクッキーを削除した後にログアウトURLを呼び出します。Callback URLとログアウトURLを設定しないと、ユーザーはアプリにログインやログアウトが行えなくなり、アプリケーションにエラーが発生します。

      アプリのプラットフォームに合わせて、対応するURLを**Callback URL** と**ログアウトURL** に追加します。カスタムドメインを使っている場合は、Auth0テナントのドメインではなく、カスタムドメインの値を使用してください。

      #### iOS

      ```
      BUNDLE_IDENTIFIER.auth0://{yourDomain}/ios/BUNDLE_IDENTIFIER/callback
      ```

      #### Android

      ```
      PACKAGE_NAME.auth0://{yourDomain}/android/PACKAGE_NAME/callback
      ```

      <Info>
      サンプルプロジェクトに沿って進めている場合は、次の設定を行ってください：

      - **iOS** ：

        `com.auth0samples.auth0://labs-fundtraining.us.auth0.com/ios/com.auth0samples/callback`
      - **Android** ：

        `com.auth0samples.auth0://labs-fundtraining.us.auth0.com/android/com.auth0samples/callback`
      </Info>
      </Section>

      <Section id={sections[1].id} title={sections[1].title} stepNumber="2">
      このセクションでは、React Native Auth0モジュールをインストールします。

      <Info>
      React Nativeの追加情報については[公式ドキュメント](https://facebook.github.io/react-native/)をご覧ください。
      </Info>

      ### Yarn

      ```bash
      yarn add react-native-auth0
      ```

      <Info>
      Yarnの詳細については、[公式ドキュメント](https://yarnpkg.com/en/docs)をご覧ください。
      </Info>

      ### npm

      ```bash
      npm install react-native-auth0 --save
      ```

      ### 追加のiOS手順：モジュールPodをインストールする

      SDKの必須最低iOSデプロイメントターゲットは13.0です。プロジェクトの「ios/Podfile」でプラットフォームのターゲットが13.0になっていることを確認してください。

      ```
      platform :ios '13.0'
      ```

      CocoaPodsは、React Nativeフレームワークがプロジェクトに自己をインストールするために使うiOSパッケージ管理ツールです。iOSネイティブモジュールがiOSアプリで動作するように、最初にライブラリーPodをインストールします。古いReact Native SDKバージョンの知識がある方には、以前のLinking a Nativeモジュールに似ています。プロセスが簡略化されました：

      ディレクトリを`ios`フォルダーに変更して`pod install`を実行します。

      ```
      cd ios
      pod install
      ```
      </Section>

      <Section id={sections[2].id} title={sections[2].title} stepNumber="3">
      はじめに、ユーザーがログインする方法を提供する必要があります。Auth0がホストするログインページを使用することをお薦めします。

      <Frame>![iOSアプリのユニバーサルログイン画面の例](/images/ja-jp/cdy7uua7fh8z/3ZRDXpjlUXEcQpXq6Q00L1/4b6b596983b5f7d257975a5efcc1cafa/login-ios_japanese.png)</Frame>

      ### Androidを構成する

      アプリケーションのディレクトリ（`android/app/build.gradle`が典型的）で`build.gradle`ファイルを開き、以下のマニフェストプレースホルダーを追加します。`auth0Domain`の値には、上で構成したようにAuth0アプリケーション設定が含まれなければなりません。

      ```
      android {
      defaultConfig {

          // Add the next line

          manifestPlaceholders = [auth0Domain: "{yourDomain}", auth0Scheme: "${applicationId}.auth0"]

      }

      ...

      }
      ```

      <Info>
      ランタイムでは、`applicationId`の値がアプリケーションのパッケージ名またはIDで自動的に更新します（例：`com.example.app`）。この値は`build.gradle`ファイルから変更できます。`AndroidManifest.xml`ファイルの上部でも確認できます。
      </Info>

      ### iOSを構成する

      `ios/<YOUR PROJECT>/AppDelegate.mm`ファイルで、以下を追加します：

      ```
      #import <React/RCTLinkingManager.h>

      (BOOL)application:(UIApplication *)app openURL:(NSURL *)url
            options:(NSDictionary<UIApplicationOpenURLOptionsKey, id> *)options

      {
      return [RCTLinkingManager application:app openURL:url options:options];
      }
      ```

      <Info>
      このファイルは、[古いアーキテクチャ](https://reactnative.dev/docs/next/new-architecture-app-intro#ios---use-objective-c-mm-extension)を使ったアプリケーションの`ios/<YOUR PROJECT>/AppDelegate.m`になります。
      </Info>

      次に、アプリのバンドルIDを使ってURLSchemeを追加します。

      `ios`フォルダーで`Info.plist`を開き、`CFBundleIdentifier`の値を見つけます。

      ```xml
      <key>CFBundleIdentifier</key>
      <string>$(PRODUCT_BUNDLE_IDENTIFIER)</string>
      ```

      この値の下に、`CFBundleIdentifier`の値を`CFBundleURLSchemes`の値として使い、URLタイプのエントリーを登録します。

      ```xml
      <key>CFBundleURLTypes</key>
      <array>
      <dict>
      <key>CFBundleTypeRole</key>
      <string>None</string>
      <key>CFBundleURLName</key>
      <string>auth0</string>
      <key>CFBundleURLSchemes</key>
      <array>
      <string>$(PRODUCT_BUNDLE_IDENTIFIER).auth0</string>
      </array>
      </dict>
      </array>
      ```

      <Info>
      アプリケーションがReact Native CLIで生成された場合、`$(PRODUCT_BUNDLE_IDENTIFIER)`のデフォルト値は`org.reactjs.native.example.$(PRODUCT_NAME:rfc1034identifier)`と動的に一致します。サンプルアプリの場合、この値は`com.auth0samples`と一致します。
      </Info>

      この値は、この後の手順で、Callback URLを定義するために使用します。以下の手順で、XCodeを用いて変更できます：

      - アプリのルートからターミナルで`ios/<YOUR PROJECT>.xcodeproj`ファイルを開くか、`xed ios`を実行する。
      - プロジェクトまたは希望ターゲットの［Build Settings（ビルド設定）］タブを開いて「Bundle Identifier」を含むセクションを見つける。
      - 「Bundle Identifier」値を希望のアプリケーションのバンドルID名と置き換える。

      詳細情報は[React Nativeドキュメント](https://facebook.github.io/react-native/docs/linking)をご覧ください。
      </Section>

      <Section id={sections[3].id} title={sections[3].title} stepNumber="4">
      `useAuth0`フックはReact Contextに依存して状態を管理します。`Auth0Provider`コンポーネントがこのコンテキストを提供します。

      `react-native-auth0`パッケージから`useAuth0`フックと`Auth0Provider`コンポーネントをインポートします：

      ```js
      import {useAuth0, Auth0Provider} from 'react-native-auth0';
      ```

      SDKが正しく機能するためには、アプリケーションを`Auth0Provider`コンポーネントでラップし、次のプロパティをセットします：

      - `domain`：Auth0テナントのドメインです。通常、Auth0 Dashboardにあるアプリケーションの設定の［Domain（ドメイン）］フィールドで確認できます。カスタムドメインを使用している場合は、代わりにその値を設定してください。
      - `clientId`：このクイックスタートで前に設定した、Auth0アプリケーションのIDです。Auth0 Dashboardにあるアプリケーションの［Settings（設定）］タブの［Client ID（クライアントID）］フィールドで確認できます。

      <Note>
      ##### チェックポイント
      Auth0Providerコンポーネントの構成が完了しました。アプリケーションを実行して次の点を確認します：
      SDKが正しく初期化している。
      アプリケーションがAuth0に関連したエラーを投入していない。
      </Note>
      </Section>

      <Section id={sections[4].id} title={sections[4].title} stepNumber="5">
      ユーザを認証するには、`useAuth0`フックが提供する`authorize`メソッドを呼び出します。このメソッドは認証のためにユーザーをAuth0ユニバーサルログインページへリダイレクトし、アプリへ戻します。

      ユーザーのログインが成功したことを確認するには、フックの提供する`user`プロパティが`null`でないことを確認してください。

      <Note>
      ##### チェックポイント
      クリックでauthorizeを呼び出すボタンコンポーネントを追加します。ログインページにリダイレクトされてから、アプリケーションに戻されることを確認します。
      </Note>
      </Section>

      <Section id={sections[5].id} title={sections[5].title} stepNumber="6">
      ユーザーをログアウトさせるには、`clearSession`を呼び出して、ユーザーをAuth0のログアウトエンドポイントにリダイレクトします。そうすると、ユーザーのセッションが認可サーバーから削除され、ユーザーがアプリケーションからログアウトされます。

      <Note>
      ##### チェックポイント
      clearSessionを呼び出すボタンを追加して、Auth0のログアウトエンドポイントにリダイレクトされ、再び戻されることを確認してください。アプリケーションにはログインしていないはずです。
      </Note>
      </Section>

      <Section id={sections[6].id} title={sections[6].title} stepNumber="7">
      `useAuth0`フックは、認証済みユーザーの情報を含む`user`オブジェクトを公開します。これを使用すると、認証済みユーザーについてデコードされたユーザープロファイル情報に、IDトークンからアクセスできます。

      ユーザーが認証されていない場合、このプロパティは`null`になります。

      <Note>
      ##### チェックポイント
      ログインして、結果のuserプロパティを調査します。emailやnameなど、現在のユーザーのプロファイル情報を確認します。
      </Note>
      </Section>

    ## 次のステップ

    成功です！ここまで来れば、アプリケーションにログイン、ログアウト、ユーザープロファイル情報が備わっているはずです。

    これでクイックスタートチュートリアルは終了ですが、機能はまだまだたくさんあります。Auth0でできることについて詳しくは、以下をご覧ください。

    *   [Auth0 Dashboard](https://manage.auth0.com/#) - Auth0のテナントやアプリケーションを構成して管理する方法について説明します
    *   [react-native-auth0 SDK](https://github.com/auth0/react-native-auth0) - このチュートリアルで使用されているSDKをより詳しく説明します
    *   [Auth0 Marketplace](https://marketplace.auth0.com/) - Auth0の機能性を拡張できる各種の統合を見つけられます
  </Content>

  <SideMenu sections={sections}>
      <SideMenuSectionItem id={sections[0].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[1].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[2].id}>
        <SignUpForm />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[3].id}>
        <App />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[4].id}>
        <App2 />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[5].id}>
        <App3 />
      </SideMenuSectionItem>

      <SideMenuSectionItem id={sections[6].id}>
        <App4 />
      </SideMenuSectionItem>

    </SideMenu>
</Recipe>
